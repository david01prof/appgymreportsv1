@if (dataRoutines()) {

<!-- Table -->

<app-top-menu-list
  [first]="first"
  [rows]="rows"
  [dataRoutines]="dataRoutines()"
  (firstout)="getFirstOut($event)"
></app-top-menu-list>

<div class="card">
  <p-table
    [value]="dataRoutines()"
    [paginator]="true"
    [rows]="rows"
    [rowsPerPageOptions]="[5, 10, 20]"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [first]="first"
    [showCurrentPageReport]="true"
    (onPage)="pageChange($event)"
    #dt1
    dataKey="id"
    [loading]="loading"
    [globalFilterFields]="['titleExercise']"
    [ngClass]="{ 'disabled-card': isCardDisabled }"
  >
    <!-- Filter -->
    <ng-template pTemplate="caption">
      <div class="flex">
        <p-button
          label="Clear"
          [outlined]="true"
          icon="pi pi-filter-slash"
          (onClick)="clear(dt1)"
        />
        <span class="p-input-icon-left ml-auto">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            [(ngModel)]="searchValue"
            (input)="dt1.filterGlobal(searchValue, 'contains')"
            placeholder="Buscar por titulo"
          />
        </span>
      </div>
    </ng-template>

    <ng-template pTemplate="body" let-routine>
      <tr>
        <td>
          <p-card [header]="routine.titleRoutine">

            <!-- Date and Status -->
            <div class="flex justify-content-between gap-2">
              <div class="text-gray-400">
                {{ routine.date }}
              </div>

              <div class="margen_tag">
                @if (routine.status == 'EnProceso') {
                <p-tag severity="success" value="En proceso" />
                } @else if (routine.status == 'Pendiente') {
                <p-tag severity="warning" value="Pendiente" />
                } @else {
                <p-tag severity="danger" value="Finalizada" />
                }
              </div>
            </div>

            <!-- Description -->
            <div>
              <p class="font-light">DescripciÃ³n de la rutina:</p>
              <p class="font-light">Total de ejercicios: {{ routine.numExercises }} </p>

              @if(routine.numSeries > 0) {
                @for (serie of routine.series; track $index) {
                  <p class="font-light">
                    Serie {{ $index + 1 }}: {{ serie.title }}
                  </p>
                }
              }
            </div>

            <!-- Buttons actions -->
            <ng-template pTemplate="footer">
              <div class="flex justify-content-center mt-1 gap-4">

                <!-- Updated -->
                <app-dialog-detail
                  [routine]="routine"
                  [isUpdate]="true"
                ></app-dialog-detail>

                <!-- Detail -->
                <app-dialog-detail
                  [routine]="routine"
                  [isUpdate]="false"
                ></app-dialog-detail>

                <!-- Delete -->
                <app-dialog-detail [isUpdate]="false" [isDelete]="true" [routine]="routine"></app-dialog-detail>
              </div>
            </ng-template>

          </p-card>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
} @else {
<h3 class="text-center">Por el momento no hay rutinas creadas</h3>
<h4 class="text-center">Quieres crear una nueva rutina ?</h4>
<h4 [routerLink]="['/newRoutine']" class="text-center text-blue-200">
  Crear nueva rutina
</h4>
}
