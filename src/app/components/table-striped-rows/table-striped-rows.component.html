<div class="card">
    <p-table 
        #dt2
        [value]="products()" 
        styleClass="p-datatable-striped" 
        [tableStyle]="{'min-width': '50rem'}"
        [paginator]="true"
        [dataKey]="getKey()"
        [rows]="5"
        [globalFilterFields]="getFilterFields()"
        [rowsPerPageOptions]="[5, 10]">
        <ng-template pTemplate="caption">
            <div class="grid">
                <p-button label="Clear" [outlined]="true" icon="pi pi-filter-slash" (onClick)="clear(dt2)"  class="col-5 overflow-hidden"/>
                <span class="p-input-icon-left ml-auto col-7 overflow-hidden">
                    <i class="pi pi-search"></i>
                    <input 
                    pInputText 
                    type="text" 
                    [(ngModel)]="searchValue"
                    (input)="onGlobalFilter($event)" 
                    placeholder="Buscar...."
                    class="w-full" />
                </span>
            </div>
        </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th *ngFor="let column of columns()" [pSortableColumn]="column.id" class="text-center"> {{column.label}} <p-sortIcon [field]="column.id" /> </th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-product>
                <tr>
                    <td *ngFor="let column of columns()" class="text-center"> 

                        @if(column.id == 'id'){
                            @if (isRegister()) {
                                Reporte {{product.idReport + 1}}
                            } @else {
                                {{product[column.id]}} 
                            }
                        }
                        @else if (column.id == 'tag') {
                            <p-tag [severity]="product['tag'].tagDropdown?.severity"> {{product['tag'].title}}</p-tag> 
                        }
                        @else if (column.id == 'exercises') {
                            {{product[column.id].length}}
                        }
                        @else if (column.id == 'created') {
                            {{getDate(product[column.id]) | date: 'dd/MM/yyyy'}}
                        }
                        @else if (column.id == 'date') {
                            {{getDate(_routineSvc.convertTimeStamptoDate(product[column.id])) | date: 'dd/MM/yyyy'}}
                        }
                        @else if (column.id == 'totaligc') {
                            @if(product["calculator"].totaligc !== undefined && product["calculator"].totaligc != ''){
                                {{product["calculator"].totaligc}}%
                            }@else {
                                0%
                            }
                        }@else if (column.id == 'actions') {
                            <div class="flex justify-content-center">
                                @if(isRegister()){
                                    <p-button icon="pi pi-eye" severity="info" [routerLink]="['/reports',{  outlets: { content: [product.id] }} ]" ></p-button>
                                }
                                @else {
                                    <p-button icon="pi pi-eye" severity="info" [routerLink]="['/routines',{  outlets: { content: [product.id] }} ]" ></p-button>
                                }
                            </div>
                        }@else{
                            {{product[column.id]}}
                        }
                    </td>
                </tr>
            </ng-template>
    </p-table>
</div>
